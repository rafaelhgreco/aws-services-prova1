{"filter":false,"title":"upload_files.js","tooltip":"/upload_files.js","undoManager":{"mark":2,"position":2,"stack":[[{"start":{"row":0,"column":0},"end":{"row":42,"column":2},"action":"insert","lines":["// uploadFile.js","const AWS = require('aws-sdk');","const s3 = new AWS.S3();","const dynamodb = new AWS.DynamoDB.DocumentClient();","const uuid = require('uuid');","","exports.handler = async (event) => {","    const { fileName, fileType } = JSON.parse(event.body);","    const fileId = uuid.v4();","    ","    // Gerar URL assinada para upload","    const s3Params = {","        Bucket: process.env.UPLOAD_BUCKET,","        Key: `uploads/${fileId}-${fileName}`,","        ContentType: fileType,","        Expires: 600","    };","    ","    const uploadUrl = await s3.getSignedUrlPromise('putObject', s3Params);","    ","    // Salvar metadados no DynamoDB","    const dbParams = {","        TableName: process.env.METADATA_TABLE,","        Item: {","            fileId,","            fileName,","            fileType,","            status: 'UPLOADED',","            createdAt: new Date().toISOString(),","            s3Key: s3Params.Key","        }","    };","    ","    await dynamodb.put(dbParams).promise();","    ","    return {","        statusCode: 200,","        body: JSON.stringify({","            fileId,","            uploadUrl","        })","    };","};"],"id":1}],[{"start":{"row":0,"column":0},"end":{"row":0,"column":16},"action":"remove","lines":["// uploadFile.js"],"id":2}],[{"start":{"row":0,"column":0},"end":{"row":1,"column":0},"action":"remove","lines":["",""],"id":3}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":0,"column":0},"end":{"row":0,"column":0},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1744493058719,"hash":"bdc816e319f87acb7763b126d74fdf900e88c044"}