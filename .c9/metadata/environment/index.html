{"filter":false,"title":"index.html","tooltip":"/index.html","undoManager":{"mark":0,"position":0,"stack":[[{"start":{"row":0,"column":0},"end":{"row":102,"column":7},"action":"remove","lines":["<!DOCTYPE html>","<html>","<head>","    <title>Lista de Arquivos Processados</title>","    <style>","        body { font-family: Arial, sans-serif; margin: 20px; }","        table { width: 100%; border-collapse: collapse; }","        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }","        th { background-color: #f2f2f2; }","        thumbnail { max-width: 100px; max-height: 100px; }","    </style>","    <!-- Load AWS SDK first -->","    <script src=\"https://sdk.amazonaws.com/js/aws-sdk-2.939.0.min.js\"></script>","</head>","<body>","    <h1>Arquivos Processados</h1>","    <table id=\"filesTable\">","        <thead>","            <tr>","                <th>ID</th>","                <th>Nome</th>","                <th>Tipo</th>","                <th>Status</th>","                <th>Miniatura</th>","                <th>Ações</th>","            </tr>","        </thead>","        <tbody></tbody>","    </table>","","    <script>","        // Configurações AWS (substitua pelas suas)","        const AWS_CONFIG = {","            region: \"us-east-1\",","            identityPoolId: \"us-east-1:XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\", // Opcional: se usar Cognito","            bucketName: \"meu-projeto-uploads-12345\"","        };","","        // Initialize AWS SDK","        AWS.config.update({ region: AWS_CONFIG.region });","        ","        // Função para listar arquivos do DynamoDB","        async function listFiles() {","            try {","                const dynamodb = new AWS.DynamoDB.DocumentClient();","                const params = {","                    TableName: \"FileMetadata\"","                };","                const data = await dynamodb.scan(params).promise();","                renderFiles(data.Items);","            } catch (error) {","                console.error(\"Erro ao buscar arquivos:\", error);","                alert(\"Falha ao carregar arquivos. Verifique o console.\");","            }","        }","","        // Renderiza os arquivos na tabela","        function renderFiles(files) {","            const tbody = document.querySelector(\"#filesTable tbody\");","            tbody.innerHTML = \"\";","","            files.forEach(file => {","                const row = document.createElement(\"tr\");","                ","                // Gera URL assinada para o arquivo (válida por 15 minutos)","                const fileUrl = generateSignedUrl(file.s3Key);","                let thumbnailUrl = \"\";","                if (file.result?.thumbnailKey) {","                    thumbnailUrl = generateSignedUrl(file.result.thumbnailKey);","                }","","                row.innerHTML = `","                    <td>${file.fileId}</td>","                    <td>${file.fileName}</td>","                    <td>${file.fileType}</td>","                    <td>${file.status}</td>","                    <td>","                        ${thumbnailUrl ? `<img src=\"${thumbnailUrl}\" class=\"thumbnail\">` : \"N/A\"}","                    </td>","                    <td>","                        <a href=\"${fileUrl}\" target=\"_blank\">Download</a>","                    </td>","                `;","                tbody.appendChild(row);","            });","        }","","        // Gera URL pré-assinada para acesso temporário","        function generateSignedUrl(key) {","            const s3 = new AWS.S3();","            const params = {","                Bucket: AWS_CONFIG.bucketName,","                Key: key,","                Expires: 900 // 15 minutos","            };","            return s3.getSignedUrl(\"getObject\", params);","        }","","        // Carrega os dados quando a página abre","        document.addEventListener(\"DOMContentLoaded\", listFiles);","    </script>","</body>","</html>"],"id":2},{"start":{"row":0,"column":0},"end":{"row":16,"column":0},"action":"insert","lines":["<!DOCTYPE html>","<html lang=\"en\">","<head>","    <meta charset=\"UTF-8\">","    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">","    <title>Listar Arquivos do S3</title>","</head>","<body>","    <h1>Arquivos no S3</h1>","    <ul>","        {% for file in files %}","            <li>{{ file }}</li>","        {% endfor %}","    </ul>","</body>","</html>",""]}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":8,"column":27},"end":{"row":8,"column":27},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1744501576942,"hash":"39297c8b12d06319335b0fcd1efe4732c7166c27"}